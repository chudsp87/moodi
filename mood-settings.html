<!DOCTYPE html>
<html>

<head>
    <title>Page Title</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="styles/style.css" rel="stylesheet" />
    <link href="styles/buttons.css" rel="stylesheet" />
    <link rel="stylesheet" href="font-awesome/css/font-awesome.min.css">
    <link href="./color-wheel/color-wheel.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.16/d3.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/es6-promise/4.1.0/es6-promise.auto.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="./color-wheel/d3-sunburst-menu-master/d3-sunburst-menu-master/src/d3-sunburst-menu.js" type="text/javascript" charset="utf-8"></script>
    <style>
        body {
        font-family: "Varela Round", sans-serif;
        margin: 0;
        width: 100%;
    }

    .updateemotion {
        height: 2.5em;
        width: 20%;
        border-radius: .4em;
        display: flex;
/*        margin: 1em;*/
    /*    padding: 3em;*/
        font-size: 20px;
/*        padding: 1em;*/
        text-decoration: none;
        text-align: center;
        vertical-align: middle;
        background-color: var(--veryperi);
        color: var(--sand);
        border: .1em solid var(--sand); 
        margin-left: 2em;
    }

    #mood-options > h3 {
        cursor: pointer;
    }

    #mood-options > h3 a:hover {
        border-bottom: .1em solid #ff7600;
    }

    </style>

<body>
    <div id="header"></div>
    <div class="row">
        <div id="sidenav"></div>
        <div class="main" style="padding: 1em 7em 1em 2em; flex-direction: column;">
            <div class="flex-1">
                <h1>Mood Settings</h1>
                <div id="mood-options" style="overflow-y: auto;">
                    <!-- <h1>Mood Settings</h1> -->
                    <h3><a onclick="startContext('mine')">Modify my own mood settings (how I display to others) <img style="height: 0.8em" src="images/new-window-icon.png" /></a></h3>
                    <h3><a onclick="startContext('others')">Modify others' settings (how I view others' emotions) <img style="height: 0.8em" src="images/new-window-icon.png" /></a></h3>
                    <h3><a onclick="startContext('color')">Modify emotion-color map <img style="height: 0.8em" src="images/new-window-icon.png" /></a></h3>
                </div>
                <!-- </div> -->
            </div>
        </div>
    </div>
    <!-- Footer -->
    <div class="footer">
        <h2>Footer</h2>
    </div>
    <script>
    function toggleOverlay(overlayId) {
        const overlays = document.getElementsByClassName('overlay');
        for (let i = 0; i < overlays.length; i++) {
            overlays[i].classList.remove('visible');
        }

        const overlay = document.getElementById(overlayId);
        overlay.classList.add('visible');
    }
    </script>
    <script>
    /* Loop through all dropdown buttons to toggle between hiding and showing its dropdown content - This allows the user to have multiple dropdowns without any conflict */
    var dropdown = document.getElementsByClassName("dropdown-btn");
    var i;

    for (i = 0; i < dropdown.length; i++) {
        dropdown[i].addEventListener("click", function() {
            this.classList.toggle("active");
            var dropdownContent = this.nextElementSibling;
            if (dropdownContent.style.display === "block") {
                dropdownContent.style.display = "none";
            } else {
                dropdownContent.style.display = "block";
            }
        });
    }
    </script>
    <script>
    /* Add click event listener to dropdown container elements */
    // document.querySelectorAll("div.dropdown-container > a").forEach(function(element) {
    document.querySelectorAll("div.sidenav > a, div.dropdown-container > a").forEach(function(element) {
        element.addEventListener('click', function(event) {
            // Remove the active-dropdown class from all dropdown container elements
            document.querySelectorAll('div.sidenav > a, .dropdown-container a').forEach(function(el) {
                el.classList.remove('active-dropdown');
            });

            // Add the active-dropdown class to the clicked element
            event.target.classList.add('active-dropdown');
        });
    });
    </script>
    <script type="text/javascript">
    $(function() {
        $("div.sidenav > a, div.dropdown-container > a").click(function() {
            $.get("#");

            return false; // prevent default browser refresh on "#" link
        });
    });
    </script>
</body>

</html>
<script type="module">
    import ColorWheel from "./color-wheel/color-wheel.js";

    

    window.startContext = async function(mode)
    {
        let domElem = document.getElementById("mood-options");

        if (window["MOODI"] === undefined)
        {
            window.MOODI = {}
        }
        window.MOODI.mode = mode;

        let r = await fetch("./color-wheel/color-wheel.json");
        let json = await r.json();
        let json2 = JSON.parse(JSON.stringify(json))
        let json3 = JSON.parse(JSON.stringify(json))

        json["name"] = "mine";
        json2["name"] = "others";
        json3["name"] = "colors";

        let interactable = mode === "color" ? false : true;
        let cw, cw2, cw3;
        if (mode === "mine")
        {
           cw = new ColorWheel({interactable:interactable, colorWheelConfig:json});
           cw2 = new ColorWheel({interactable:interactable, colorWheelConfig:json2});
           cw3 = new ColorWheel({interactable:interactable, colorWheelConfig:json3});
        } 
        else
        {
           cw2 = new ColorWheel({interactable:interactable, colorWheelConfig:json2});
           cw = new ColorWheel({interactable:interactable, colorWheelConfig:json});
           cw3 = new ColorWheel({interactable:interactable, colorWheelConfig:json3});
        }

        let html = await cw.generateHTML();
        let html2 = await cw2.generateHTML();
        let html3 = await cw3.generateHTML();

        let wrap = document.createElement("div");
        let wrap2 = document.createElement("div");
        let wrap3 = document.createElement("div");
        wrap.style.height = "500px";
        wrap2.style.display = "none";


        if (mode === "others" || mode === "mine")
        {
            wrap3.style.display = "none";
            let otherMode = mode === "others" ? "mine" : "others";

            domElem.innerHTML = `
            <h5><a href="./mood-settings.html">\<\< Back</a></h5>
            
            <h1>Modify ${mode} emotions settings</h1>
            `;
            domElem.innerHTML += `
            <h3>Modify Emotion State</h3>
            <h5>Click on an emotion to enable or disable it and its children.</h5>
            
            `;
        }
        else
        {
            wrap3.style.height = "500px";
            wrap.style.height = "0px";
            domElem.innerHTML = `
                <h5><a href="./mood-settings.html">\<\< Back</a></h5>
                <h3>Modify Emotion Color</h3>
                <h5>Type in an existing emotion and select a color value to change it to. <br>Note that these colors are subjective to you only.</h5>
                <br>
                <br>
                <div>
                    <div class="dropdown-list">
                        <label for="emotionname" style="font-size: 110%;">Select an emotion:</label>
                        <select name="emotion" id="emotionname" style="cursor: pointer; width: 18%; font-size: 110%;   font-family: "Varela Round", sans-serif;">
                            <option class="top-option" value="surprise">SURPRISE</option>
                            <option class="sub-option" value="amazed">-&nbsp; AMAZED</option>
                            <option class="sub-option" value="confused">-&nbsp; CONFUSED</option>
                            <option class="sub-option" value="excited">-&nbsp; EXCITED</option>
                            <option class="sub-option" value="anxious">&nbsp;&nbsp; -&nbsp; ANXIOUS</option>
                            <option class="sub-option" value="nervous">&nbsp;&nbsp; -&nbsp; NERVOUS</option>
                            <option class="sub-option" value="startled">-&nbsp; STARTLED</option>
                            <option class="top-option" value="happy">HAPPY</option>
                            <option class="sub-option" value="joyful">-&nbsp; JOYFUL</option>
                            <option class="sub-option" value="optimistic">-&nbsp; OPTIMISTIC</option>
                            <option class="sub-option" value="peaceful">-&nbsp; PEACEFUL</option>
                            <option class="sub-option" value="proud">-&nbsp; PROUD</option>
                            <option class="top-option" value="sad">SAD</option>
                            <option class="sub-option" value="bored">-&nbsp; BORED</option>
                            <option class="sub-option" value="despair">-&nbsp; DESPAIR</option>
                            <option class="sub-option" value="guilty">-&nbsp; GUILTY</option>
                            <option class="sub-option" value="lonely">-&nbsp; LONELY</option>
                        </select>
                    </div>
                    <div style="margin-top: 1em; font-size: 110%;">
                        \tSelect desired color:\t
                            <input type="color"  style="height: 4em; width: 15em; cursor: pointer;" value="#ff0000" id="emotioncolor">
                        
                        
                    </div>
                    
                    <br>
                    <br>
                     <div align="center"><a class="updateemotion" id="updateemotioncolor" style="cursor: pointer;"><span style="vertical-align: middle; margin: auto; margin-top: -.5em; padding: 0; font-weight:500; cursor: pointer;">Update</span></a></div>
                </div>
                `;

            updateemotioncolor.onclick = ()=>{
                MOODI.setEmotionColor("mine", document.getElementById("emotionname").value.toLowerCase(), document.getElementById("emotioncolor").value+"")
                MOODI.setEmotionColor("others", document.getElementById("emotionname").value.toLowerCase(), document.getElementById("emotioncolor").value+"")
                MOODI.setEmotionColor("colors", document.getElementById("emotionname").value.toLowerCase(), document.getElementById("emotioncolor").value+"")
            }

            
        }

        domElem.appendChild(wrap);
        domElem.appendChild(wrap2);
        domElem.appendChild(wrap3);

        if (mode === "mine")
        {
            window.MOODI.primary = cw;
            wrap2.appendChild(html2);
            wrap.appendChild(html);
        }
        else
        {
            window.MOODI.primary = cw2;
            wrap.appendChild(html2);
            wrap2.appendChild(html);
        }
        wrap3.appendChild(html3)
    
    }

    
</script>